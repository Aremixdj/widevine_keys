import requests

headers = {
    'Connection': 'keep-alive',
    'Pragma': 'no-cache',
    'Cache-Control': 'no-cache',
    'sec-ch-ua': '" Not A;Brand";v="99", "Chromium";v="96", "Google Chrome";v="96"',
    'DNT': '1',
    'sec-ch-ua-mobile': '?0',
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.45 Safari/537.36',
    'sec-ch-ua-platform': '"Windows"',
    'content-type': 'application/json',
    'Accept': '*/*',
    'Origin': 'https://hd.kinopoisk.ru',
    'Sec-Fetch-Site': 'cross-site',
    'Sec-Fetch-Mode': 'cors',
    'Sec-Fetch-Dest': 'empty',
    'Referer': 'https://hd.kinopoisk.ru/',
    'Accept-Language': 'ru-RU,ru;q=0.9,en-US;q=0.8,en;q=0.7,id;q=0.6,de;q=0.5,zh-TW;q=0.4,zh-CN;q=0.3,zh;q=0.2,uk;q=0.1',
}

data = '{"rawLicenseRequestBase64":"CAES8R8SXQpbCkUIARIQy8Z1jMAZRKm1xt0uRD4eRhoNd2lkZXZpbmVfdGVzdCIgNDMxNTA4MjQ4OWQ4NzY3N2IyMWY3YzgzNTkzZmNiNzMQARoQWgYvKbzIOJl9eDFDDeK5axgBINSnr40GMBU49v7tK0KAHwoUbGljZW5zZS53aWRldmluZS5jb20SEBcFuRfMEgSGiwYzOi93KowawBy77FxGWWukCnw4RVYaIR8wihJ95GwfRMJkN6QR4s-3C_UV4MRCFOgAH7ecHADO4Nxy5DADgAmr2VFBjuhNZDMwmPq9KRegXNZJ8RM-iU56bupyHlT6ZTUOlFdfvH6_jTPPYvNjGp69DSItJl6t7kmV7mN6C7Uh3xmOsVeNszc31MVprGVSyzwBTagqyf3pe0o-s5Y6liI_nKofE6DXvHFfsfl2OfYhd8skyR7Cl6lbBIDAPQHRkyJGTTfta8j9yWnkdRG3gFMv_yo72p17GdRuYiFaulF9P2ar5Dx5en5ggkxJBhp5s0dAx-lfSPvaomcGCFS8SErpCLZ05oc_JGdvDI-Ek7HFy2-mJv_oLkO4Dng7S7R9DI82nCvegQE1b26EjjUbRm_K4kSWonQR71ENBsTObXlANyPYVYJ2QngN9yG8ldRXJ94uvI-lcskmdytMW7jm_H6SuPg0J0_jaX4wzBlONg4OZNjyfuRgweFIr6lchM8QMJxGyoq7sEJqK8lBKU0B4Mo_OX1cZzfBisY8Et-hNN6yutBwTNTIX3VBhwaSsTqAkx6h9N1x2Xi_r7WL2ni16qenhDp-Nf3CjkTi6aZWsi63i_aXF6I77XlSw28kkpJaSdKk8_g_CmziZ9XeDrhL7QoKiVOZITCQLvbZGdDEf7D6yEMbMbUu7w0X9-gYdvWOisyAWRnqPiFGiUBwE_9cmhd-rCil2DbwVzG-18ZRaro4J2co_2Q6-yTrjdto2ngFg3MhlLG0oCbD1VeMksPe8LUhU1p0V8Nc_uirBQ5fxn_77AmbZA2m_t3myV67qy1BNXwTPeQvdT58EFO1udijeJVTIpal-G3qxctIC0N7L1kQQf7stObl0ZBkrP5-s4g9Xq4IoQiuFaaYYPDwZSXWC7h88WZKwT9-4QjMvIqpjDoxsRDSz7EjuMFV2waFC9lzcIGRtuzWHStPbXTR1mLKzQrS5PAs4YOL5dtsSMwsa-SbHyicFwaU1pH6onFuevk5he8kc_bXbk9wi73qQVc3u4yaxZ-Jg5IOdAJBAFo2DI_27YhivSfHz9l8YpMizmQrpKS8ozHbzGO6fR0RAGlnJHaAv7rbIEHKdXDytpjYxaI_G1tO-nYDcBANQFIg-vvg7atMPTYeyLNbn56IO4DKDLRt25dm-Q08VuFAVTqwnibP2K80FgUfsVRvrzCU19sQOyhnyVVrZsEPgyZ1PI4MsOxTJ1tzjV7ZkOEx-c6QJQJO_9JnzYHQKyDb91JyTaq3Q36U6htYKZiknR2WXUfMVYBmQyJg4Db6tTkreuPeqHa0qgpC4lNNJX8JMqBsBPNKEaxuVa2iwIPP2cuxK6rgjpUM4-dZjjYi8L5uKKKGLBfZ1PY1ATVkFp12sivPSMWb2gMeYaj1pevtA_6Ve-sk7HsSLGPrGQd7WvenJUAr1t9HVZsaPMNE-8J6Q4lqmvaqvFve7dxjAPO4iaL5uGoFBXkqgzpAMFTAjYlgSe9h_Yn6auYIsfKi1foT-hzyygKMWXqQFZA4GNP_QHi6I_IS41Y3cIYHMRHVRSweKn58H74J1ods8YJxp861VnBggmn8ZGXsUsbNl0AJmVyz7FyFdUD1rcKSfzeXQ_HTpx5mJZBNrYOY3XYMJX0tCqpSGPVYhqYKfTZVZ760ol4oVTJ3-7g0yHw6Xcz2Q9uZmQQQilDHiPVSfHV4J7q4FGDXTeZGGb3_lj38FI36zDko-n8rW0lSJ9qU1l7u4WFIvnNUO5BQKgFniwVUd3nWIwZFJ1fNLaaPhnYdPWrN0tIfW74CqU5tOZPCchOtMXnGzL1_kSazNKIT9bpnav4aAtrPEiuCCBZktzTSarkQGwjknPjOp1yfBzCmB79-HAvZboS6g5kMJVOxqXZiL1wDOO0X3e_1cAZ7uui4-D3HwmjGmfDIVHcUSdrslaVaPJiHds0sBgSiecWRDtSBDMwx3Cb37V_WRZym3rdWBpRz_Y2EwMKHkAtTIiq3Sk4tM1fXNJCAmRYHvmUvhwZ5JKYoabhv8gK4nkC8ZLou0YaqsiPHnLl6Lp9290y_Hjg2useABTEU3RoVcnF8F7uSszJKk8gAX5-ZWyiwz1-SuCoGn0KOyZbmMH2jOWoTow9bZi0mYKKs8Y6eRxOlcTrlJMW0zd8_XxsU6s7LuBd6dyGk-0Jm6X4V1To7StAUqhmWxE9tqYj9bZf08cpdUs9CFcZLa3UGdB4AH5LpgbTU6X3SFcGVsNrKzpmBkTl1STCs6-jK4ZpOhWkVA6FVCwxmw6ffueW8d-jN0L03nmo9lOabMoFvq05GpT6Xr67nOshcnwbCpZeZOgolh0BcudJuimhMouVM63ShUvJbaTlYN3DByJS3ALqBiEXcFTUHUWPSbH2EO_TOSbuYPSIK3QpYU0WU3V0QRPlqQLW9BRbIgs-WlLkz6ipAk2dqqPNBDer3ZyIpCFRbYivJm-n4ZWoM35b5sg_oJsigyJ2tVR8M6wnoIprDAaE_71TYLKCoVmYR74i45LDrimyEDy0pfC3ZOpT7UJavEIbJLo3YAsQMuUEZZQJFz2JM_vq16YeOgr0XF5bTt6oAtWm9XQBMXO3Ur1iIIu_BJqHBfdLnGMbIbh0nXjjMJJT2v-tvZ0yUrHNreAxsEANYFOBwaClmuAcKZgZSBnPtQMgYLnrXnSiLAOYqnYYmBuXIJyd9xjYVVFqP62qkKSJ_Hpu15tXgP5FWnAQ9PRWhPahkt_YokMpQT_Ka2Wx0mm3vunENxUTFVJeQXuFLgNxjPDen-ok23M_SMNiC4fowzF0XielyQxCg-t2O1xEWlvIhPrOmnrc1dYU7g04MmvMNdzTsktShy62dCmogHU4Qd50M78LnL-yjfdDVFqBrbOvc5jm9mQWRLVtqTddunHRftxRRKa4jTbAK61rHqGoEzWF_2MGLAsFUJpkX7XEf-UXYx82MHFpukZLOeIGBLkaYO7zlT52m7se8lAJKk_mhL76JmUM-NPdEF1jyfHnj3tFMbOeGFfM6oEdP295rfjX9B2Sxk4s37nDBASuZ4B45XgvWVhouIyovtLyK8ay3rQfMN86SH738e2T3AT_ZcKrK-0yJzgTyu4eZVxQNL1SYghTlhZnhBy435Q0iTGsnVT0qZq1B5OOskKmmYKzSGVhhLIFs_ZjKCz3-mveC-JvXlFf94-VfE53Kes2w0dl5al7GbltMBZJh7KM5g-syL6faez3jlwqm0WjC0WNXHvBjYBI2iTm7RuisFIO8oU2uamzqN8zjGUhRsqHTI7fzOWEYso1aH7_Y1-HXdk7_7RxX3qXgRLsDNGQtHx6EmrZCsd6pF33tRvLYulUgr9VeRr_Cqh2mz3sbtYmPIcF1hQtc-xDwPkz1ohYOWFDufYtrM20iW-ilnVUkE1gK92u4QDFiMM-NE1T7CoNPwHUHt5xewrNGyxfWy37rUNFTlSa4svAz5pPwhRED9Q2iBfJsT8ZyywUKN72Ck4m57BJQYzUAYFMRtrGa3x8pHhoYT0y8vuYQPSDKx48jnmPkiX7gGYjFbOlXjCnD6BljzVFu9ySAZS8ohnXe-64D8UXbgi0Vu-jpBcuGyldl7tgCEg6It1Os2mdemee6DjH0ghgZgTgEOWvC5MDv9hVX5YVk2xggxrRppFq65Ilfv0AFb_4kTL5Wdvy0uSB7vabfGh-fh7bKM1z58kbodjZbuh8ngnR4Cd6FpfRM672zvvQYjhrPwIya-T55ViVCF3FlEs8ePlqK9KWpDUEU2dZtcEUjaFpSmXiiaR8-yoH-PDD35IAR6y-c24qareb-MJXrnP4HzGWBRVzJ0zI-SbbPIZMFf4i9PYulg0v_0-Izqd9GqdHR5ecHEBpUkygFvGIOgAOgWEWtd-VPb0AKhGzwaTyoTgTBPb-KNAvkIXxxSaedx7BHM_dukVsnf4ITihhmvW3dtf53PN97fhq8VwsM9mps8BdauUQZjVWK1b4xDYOQe_esmuqtqQ-cjP1qrhxXvtcJiFv4dTj_3ISQcfxwaYBKOayP3Y547sD734vgG9BEqBUj1w2x4l-mmMBbITcGu0GvQAG2DtAdVERx1DkuAgL5V95y1wH0KCVRuXnqFlDY0FVcnqmrGCQWmnfH-41wWX9_Bi-QlQ8VYgp0XJvAinohjRMoxqtRpzsoX4eOjeP2CqeCR_gFQo0XOyoBjqVX_C2iaG-hwc4jqhFy1ZZH-_FXiHL6J7KKTw4TdpYFA91DWkZzj_Oyc56GV-HNLAh4WwsJNViQQFUml5VT-hQcpoopcnCnauWsiz9bhIMOtSmLSJWdkhvnD5X1k1QRU4xU8HFdcMHt0dgrL498EufDPoKAmlNFaMevboeg2BYiYlkOvWw7p_VTWHBzfYxNB3ohRlTV_aZJRe0pkw7NbOX16rXf0FGSpaaEpfba1R7o6W-AbMT2DD-7Z-xknZWZ6BTKpWB_Nt86C02qawqOFKbSRPjmqGOu86PeGppPM4Ps7_YEQrLtu6muXWyXcWNA4c1G98wZy5aQ3Txi5nbnSE0hjhf4vepKVE6ur0GOpEWk7sfQ7qgvWuP8z_12vexgzV5G0r4pcf2xh_DGI79sf6sp3jOOTmnia3fGkpp1DZoxbhBOOIX5I7THOio9u1nJmoLU_0MOcc7PNKt4WLO2JukA8I3SOpu8as_tZgQ8GFxdUXsPVOpUGz6bpAn70RyNw-jlMjZJnXGYUe3LtL7Wsd8tWhcUuAjYFCh5f0mSTk-Of0oHKF75p8wW8FncZNjw3OQ4VksJn3CJFf2wv2_ceHI8YXHQYtLNuAcCBiCDYugxpKHFgRZ3os8BqEsdLOhRCNSdyp9_Oy-bnN6ToTFSHirMRNHT9vMiEOWYmt387aY0oGvF-L-UIGQqgAI4EHRoAqekJnGKrcaXwkW_b__z2r5353a_s6iFuGONG1ju-sIec55gcfAZd-C5jk__0RWllRF7io1TQV_alvo6K5IHLda_eE2gRKIaIgDbAPy4HV3GLHcuyu1RofVkFYybLXq757vQVXlX0yxv2PPS2yAQmvTR-3LVv8sBKamk0z6fE7EaIeLi92nq_csW7dd2g0Gy9ugktP3_SxhwtqVsdCMjARRS2KGW2JA_SrqjLgcv52844RDwt2nBOmsmvG2o-fyMGW4BexgY51HKT1CV8H_kwzrT4V28DfPby7aVBFf1J43juvesVNlojalgfQilCXiiBzZQw4g3QLdFgwjqGoABc7qUVpKnw8GrktdhUIiDxkGJxL0CqJEw4Wh2NsCnIQXyk6MwFtKY5zOJChtnOUoc47YRICl68vSwK0pb5y4DezzqhhYiOsf-VnZTWDrF26lnJOXKb3k4vSxYpALcas5kDZrYtRR2MTfu8-gfbFq_3TPnvhK2uheycf3TExbNAMRKFAAAAAEAAAAUAAUAEAV7f3b_tvcy","puid":339572866,"watchSessionId":"7cfc008a852e4ac2b1922448250b83df","contentId":"4315082489d87677b21f7c83593fcb73","contentTypeId":21,"serviceName":"ott-kp","productId":2,"monetizationModel":"SVOD","expirationTimestamp":1638672434,"verificationRequired":true,"signature":"d561b865465f2a94f9eec7481d3dd3292f1752f5","version":"V4"}'

# response = requests.post('https://widevine-proxy.ott.yandex.ru/proxy', headers=headers, cookies=cookies, data=data)

# print(f'{chr(10)}widevine_license: {response.content}')
#NB. Original query string below. It seems impossible to parse and
#reproduce query strings 100% accurately so the one below is given
#in case the reproduced version is not "correct".
# response = requests.options('https://api.ott.kinopoisk.ru/v12/license-affected-content-metadata?contentIds=4b63db58ab27e92b90a457e533b00007&serviceId=25', headers=headers)
# dash-cenc/hdr10_uhd_hevc_ec3.mpd
# https://strm.yandex.ru/vh-ottenc-converted/vod-content/4315082489d87677b21f7c83593fcb73/8614535x1631802676x41611665-4e76-41ac-93a7-5070b77b5f3c/dash-cenc/sdr_uhd_hevc_ec3.mpd